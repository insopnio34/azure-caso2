---

# se ha de ejecutar el siguiente comando para que el root pueda ejecutar kubectl
#- name: Activar al root para ejecutar kubectl
  #command: export KUBECONFIG=/etc/kubernetes/admin.conf
  #become: yes
  #become_method: sudo

# se ha de ejecutar el siguiente comando para que el root pueda ejecutar kubectl
# crear directorio Kube
- name: Crear directorio kube
  file:
    path: /root/.kube
    state: directory
  become: yes
  become_method: sudo

#copiar configuracion kube
- name: Activar al root para ejecutar kubectl
  command: cp -i /etc/kubernetes/admin.conf /root/.kube/config
  become: yes
  become_method: sudo


#modificar propietario usuario
- name: modificar  propietario
  file:
    path: /root/.kube/config 
    owner: "{{ ansible_effective_user_id }}"
    group: "{{ ansible_effective_group_id }}"
    become: yes
    become_method: sudo
  #command: sudo chown $(id -u):$(id -g) /root/.kube/config
  #command: chown root. /root/.kube/config
  #become: yes
  #become_method: sudo

- name: Obtener nodos
  command: kubectl get nodes
  become: yes
  become_method: sudo